### リリースの種類を整理する

リリースにはいくつか種類があります。
パッケージアプリにはデバッグビルドとリリースビルドがあり、
Webアプリには本番環境と開発環境などがあります。

全てのリリース形態に対して、自動でリリースできるようにします。
capistranoの場合、複数のデプロイ環境を持つことができ、
それぞれ別のブランチや設定を指定できます。

#### Webのデプロイ環境例

Webアプリの場合、最低でも次の環境が必要です。

#### production (本番環境)

実際にユーザがアクセスする本番環境です。
データは基本的にユーザが登録していくものだけです。
「本番でテストデータ500件登録させてくださいー」とか言ってくるバカ(実在)は全員ぶっ殺しましょう。

#### staging (本番と同じ状態の開発検証環境)

本番環境と同じコードが動いている開発検証環境です。
本番環境で出たバグを再現させて検証/修正したり、
APIを提供している場合は他チームの開発環境から繋いだり、
「本番でテストデータ500件登録させてくださいー」とか言ってくるバカ(実在)に「stagingでやれ」って言ったりします。

#### develop (開発用環境)

開発者が開発用に自由にいじる環境です。
開発中の機能を確認したり、仕様バグを洗い出したりします。
常に新しいコードがデプロイされるので不安定になったりもするので、
他チームからはあまり繋がせるべきではないと思います。
「dev動かなくなってるんですけどー 困るんですよねーこっちも開発止まっちゃうんでー」とか言ってくるバカ(実在)には「stagingでやれって行ってんだろクズ!」って言っておきましょう。

### リリースを踏まえたリモートブランチ運用

Webの場合、最低でも上記3つの環境が必要になります。
これらの環境にどのブランチをデプロイするか決めます。

productionとstagingは、動いているコードなので **masterブランチ** をデプロイします。
developには開発中のコードが入るので、masterブランチではありません。 **developブランチ** をデプロイすることにします。

他にも、大規模な変更がある場合、専用の開発環境とそれに対応するリモートブランチを作ります。
ミドルウェアのバージョンアップや、なぜか頻繁にあるサイトリニューアルなどの場合です。
扱いはdevelop環境と同じです。
